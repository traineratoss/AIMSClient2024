<script setup>
import { defineProps, ref, computed, defineEmits } from "vue";
import CustomButton from "../components/CustomButton.vue";
import router from "../router";
import { logout } from "../services/user_service";

const dashboardIsHovered = ref(false);

const props = defineProps({
  element: {
    type: Object,
    required: true,
  },
  disabled: {
    type: Boolean,
    required: true,
  },
  image: String,
});

props.element.forEach((element) => {
  element.isHovered = ref(false);
});

function onMouseEnter(element) {
  element.isHovered = true;
  dashboardIsHovered.value = true;
}

function onMouseLeave(element) {
  element.isHovered = false;
  dashboardIsHovered.value = false;
}

const onClickHandler = async (element) => {
  if (element.id === "logout") {
    await logout();
  }

  router.push(element.route);
};

const shouldDisableDiv = computed(() => {
  return props.disabled && !dashboardIsHovered.value;
});
</script>

<template>
  <div
    class="main-container"
    v-for="element in element"
    :key="element"
    :style="`display: ${shouldDisableDiv ? 'none' : 'block'};`"
  >
    <CustomButton
      :id="element.id"
      :style="{
        display: 'flex',
        alignItems: 'center',
        borderColor: 'black',
        borderWidth: '1px',
        whiteSpace: 'nowrap',
        width: '100%',
        textAlign: 'right',
      }"
      @mouseenter="onMouseEnter(element)"
      @mouseleave="onMouseLeave(element)"
      @click="onClickHandler(element)"
    >
      <span class="material-symbols-outlined">
        {{ element.icon }}
      </span>
      <span style="flex: 1">{{ element.name }}</span>
    </CustomButton>
  </div>
</template>

<style>
#all-users,
#stats,
#reported-comments,
#profile,
#change-password,
#dashboard,
#logout,
#my-ideas {
  background-color: white;
}

#all-users:hover,
#stats:hover,
#reported-comments:hover,
#profile:hover,
#change-password:hover,
#dashboard:hover,
#logout:hover,
#my-ideas:hover {
  background-color: var(--selected-color);
}
</style>